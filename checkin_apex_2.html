<apex:page docType="html-5.0"
sidebar="false" 
showheader="false"
standardStylesheets="false"
Controller="CheckInController" 
applyHtmlTag="false"
applyBodyTag="false"   
id="todo"
>
<html>
<head>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
  <!-- <script type="text/javascript" src="scroll.js"></script> -->
  <apex:includeScript value="{!URLFOR($Resource.RollCallAssets, 'scroll.js')}"/>
  <apex:stylesheet value="{!URLFOR($Resource.RollCallAssets, 'style.css')}"/>
  <link href='http://fonts.googleapis.com/css?family=Hammersmith+One' rel='stylesheet' type='text/css'> </link>
  <title>RollCall</title>
</head>
<body>
  <div id="select_event">
    <p> Salesforce Workday </p>          
  </div>

  <apex:outputLink value="{!$Page.event}"> 
  <div class="invisible" id="return">
  </div>
</apex:outputLink>

<div id="container">
 <section id="one" class="active">
  <div class="checkin">
    <p id="checkin_title"> Enter your <span class="blue_text"> email </span> to check in: </p>
    <input type="text" name="email" id="email"/>
    <a id="submit" data-section="two" href="#" onclick="check_in_attendee_javascript()">  
      <p> Check In </p>
    </a>
  </div>
</section>
<section id="two">
  <div class="checkin">
    <div id="confirm_info">
      <p> You are checking in as... </p>
      <div id="checkin_name">
        <p> Name: <span class="blue_text"> </span> </p>
      </div>
      <br></br>
      <div id="checkin_email">
        <p> Email: <span class="blue_text"> </span> </p>
      </div>
      <br></br>
      <div id="checkin_company">
        <p> Company: <span class="blue_text"> </span> </p>
      </div>

      <div id="test"> </div>  <!-- A div for injecting tests into -->

    </div>
    <a id="confirm" data-section="three" href="#"> 
      <p> Confirm </p>
    </a>
    <p id="confirm_end"> Otherwise, please <a class="blue_text" data-section="one" href="#"> retry</a> checking in or <a class="blue_text" data-section="four" href="#"> update</a> this information </p>
  </div>
</section>
<section id="three">
  <div class="checkin">
    <img id="checkin_icon" src="checkin.svg"> </img>
    <p id="checkin_confirmation"> Your attendance has been <span class="blue_text"> recorded! </span> </p>
    <a id="checkin_end" data-section="one" href="#"> 
      <p> Return </p>
    </a>
  </div>
</section>
<section id="four">
    <div class="checkin">
        <div class="column">
            <p class="label"> First Name: </p>
            <p class="label"> Middle Name: </p>
            <p class="label"> Last Name: </p>
            <p class="label"> Email: </p>
            <p class="label"> Company: </p>
        </div>
        <div class="column">
            <input type="text" name="firstname" class="input" placeholder="Kevin"/>
            <input type="text" name="middlename" class="input" placeholder="TianXiang"/> 
            <input type="text" name="lastname" class="input" placeholder="Wu"/>
            <input type="text" name="email" class="input" placeholder="kevintxwu@gmail.com"/>
            <input type="text" name="company" class="input" placeholder="Salesforce"/>
        </div>
        <a id="update" data-section="three" href="#"> 
            <p> Confirm </p>
        </a>
    </div>
</section>
<section id="five">
    <div class="checkin">
        <img class="checkin_icon" src="help_alt.svg"> </img>
        <p id="checkin_confirmation"> Seems like you haven't <span class="blue_text"> registered. </span> </p>
        <a class="checkin_end" data-section="four" href="#"> 
            <p> Register </p>
        </a>
        <p id="register_end"> If you remember registering, please <a class="blue_text" data-section="one" href="#"> retry</a> checking in. </p>
    </div>
</section>
</div>
</body>

<script>
$(document).ready(function(){
  $('a').on('click', function(event) 
  {
    event.preventDefault();
    var sectionId = $(this).attr("data-section"),
    $toSlide= $("#container section#"+sectionId),
    $fromSlide= $('.active');
    if (!($toSlide.hasClass("active")))
    {  
      $fromSlide.animate({"left":"-100%"},100,'linear')
      $toSlide.animate({"left":"0%"},100,'linear',function()
      {    
        $fromSlide.css("left","100%");
        $fromSlide.removeClass("active");    
        $toSlide.addClass("active");    
      });
    }
  });
});
</script>

<script type="text/javascript">
function check_in_attendee_javascript() {
 Visualforce.remoting.Manager.invokeAction(
   '{!$RemoteAction.CheckInController.check_in_attendee}',
   '{!event.id}',
   document.getElementById("email").value,
   function(result, event){
     console.log('result: ' + result);
     if (event.status) {
       // Get DOM IDs for HTML and Visualforce elements like this
       // document.getElementById("test").innerHTML += "Received email: " + document.getElementById("email").value;
       if (result.length != 0) { // successfully found match in database !
          document.getElementById('error').innerHTML = "";
          document.getElementById("checkin_email").innerHTML = "<p> Email: <span class='blue_text'>"  + document.getElementById("email").value + "</span> </p>"; 
          document.getElementById("checkin_name").innerHTML = "<p> Name: <span class='blue_text'>"  + result[0] + " " + result[1] + "</span> </p>"; 
          document.getElementById("checkin_company").innerHTML = "<p> Company: <span class='blue_text'>"  + result[2] + "</span> </p>"; 

       } else { // could not find match in database
          document.getElementById("confirm_info").innerHTML = "<div id='error'><p> Sorry. We could not find " + document.getElementById("email").value + " in our system.</div><div id='checkin_name'></div><br></br><div id='checkin_email'></div><br></br><div id='checkin_company'></div>";
       }
     } else if (event.type === 'exception') {
       document.getElementById("test").innerHTML += event.message + "<br/>\n<pre>" + event.where + "</pre>";
       console.log('swag');
     } else {
       document.getElementById("test").innerHTML +=event.message;
     }
   }, 
   {escape: true}
   );
}
</script>


<script>
function getParameterByName(name) {
  name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
  var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
  results = regex.exec(location.search);
  return results == null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
}
</script>

</html>
</apex:page>